{"version":3,"file":"index.8f5ea17c.js","sources":["../../vite/modulepreload-polyfill","../../main.js"],"sourcesContent":["const p = function polyfill() {\n    const relList = document.createElement('link').relList;\n    if (relList && relList.supports && relList.supports('modulepreload')) {\n        return;\n    }\n    for (const link of document.querySelectorAll('link[rel=\"modulepreload\"]')) {\n        processPreload(link);\n    }\n    new MutationObserver((mutations) => {\n        for (const mutation of mutations) {\n            if (mutation.type !== 'childList') {\n                continue;\n            }\n            for (const node of mutation.addedNodes) {\n                if (node.tagName === 'LINK' && node.rel === 'modulepreload')\n                    processPreload(node);\n            }\n        }\n    }).observe(document, { childList: true, subtree: true });\n    function getFetchOpts(script) {\n        const fetchOpts = {};\n        if (script.integrity)\n            fetchOpts.integrity = script.integrity;\n        if (script.referrerpolicy)\n            fetchOpts.referrerPolicy = script.referrerpolicy;\n        if (script.crossorigin === 'use-credentials')\n            fetchOpts.credentials = 'include';\n        else if (script.crossorigin === 'anonymous')\n            fetchOpts.credentials = 'omit';\n        else\n            fetchOpts.credentials = 'same-origin';\n        return fetchOpts;\n    }\n    function processPreload(link) {\n        if (link.ep)\n            // ep marker = processed\n            return;\n        link.ep = true;\n        // prepopulate the load record\n        const fetchOpts = getFetchOpts(link);\n        fetch(link.href, fetchOpts);\n    }\n};__VITE_IS_MODERN__&&p();","import './style.css';\nimport {Map, View, Overlay, Feature} from 'ol';\nimport TileLayer from 'ol/layer/Tile';\nimport VectorLayer from 'ol/layer/Vector';\nimport Point from 'ol/geom/Point';\nimport Proj from 'ol/proj/Projection';\nimport {TileImage, Vector} from 'ol/source';\nimport {getCenter} from 'ol/extent';\nimport {platformModifierKeyOnly} from 'ol/events/condition';\nimport {Stroke, Fill, Style, Circle} from 'ol/style';\nimport {DragRotate, defaults as defaultInteractions} from 'ol/interaction';\nimport {FullScreen, defaults as defaultControls} from 'ol/control';\n\nimport dataJSON from './data.json'\n\n// detect device for marker size //\n\nconst deviceType = () => {\n    const ua = navigator.userAgent;\n    if (/(tablet|ipad|playbook|silk)|(android(?!.*mobi))/i.test(ua)) {\n        return \"tablet\";\n    }\n    else if (/Mobile|Android|iP(hone|od)|IEMobile|BlackBerry|Kindle|Silk-Accelerated|(hpw|web)OS|Opera M(obi|ini)/.test(ua)) {\n        return \"mobile\";\n    }\n    return \"desktop\";\n};\n\n// create a SVG that is the same dimension as in D3.js (?)\n\nconst width = 4095;\nconst height = 4095;\n\nconst extent = [0, 0, width, height];\nconst projection = new Proj({\n  code: 'pixels',\n  units: 'pixels',\n  extent: extent,\n});\n\n// popup behaviour\n\nconst container = document.getElementById('popup');\nconst content = document.getElementById('popup-content');\nconst closer = document.getElementById('popup-closer');\n\nconst overlay = new Overlay({\n  element: container,\n  autoPan: {\n    animation: {\n      duration: 250,\n    },\n  },\n});\n\n // Add a click handler to hide the popup.\n // @return {boolean} Don't follow the href.\n\ncloser.onclick = function () {\n  overlay.setPosition(undefined);\n  closer.blur();\n  return false;\n};\n\n// create map //\n\n\nconst map = new Map({\n  // pixelRatio: 1,\n  // pixelRatio: Math.max(2, ol.has.DEVICE_PIXEL_RATIO),\n  layers: [\n    new TileLayer({\n      preload: Infinity,\n      extent: extent,\n      source: new TileImage({\n        url: './maptiles/{z}/{y}/{x}.png',\n      })\n    })\n  ],\n  overlays: [overlay],\n  target: 'map',\n  view: new View({\n    center: [0, 0],\n    zoom: 2,\n  }),\n  target: 'map',\n  view: new View({\n    projection: projection,\n    center: getCenter(extent),\n    zoom: 2,\n    maxZoom: 6\n  }),\n\n  // controls: defaultControls().extend([new FullScreen()]),\n\n  // use ctrl/cmd + drag for rotation //\n  interactions: defaultInteractions({altShiftDragRotate: false}).extend([new DragRotate({condition: platformModifierKeyOnly})]),\n\n});\n\n// add marker layer //\n\nvar vectorLayer = new VectorLayer({\n    source: new Vector(),\n    style: new Style({\n        image: new Circle({\n          fill: new Fill({color: \"rgba(0, 0, 0, 0)\"}),\n          // stroke: new Stroke({color: 'black', width: 0.3}), // for debug\n          // radius : 8\n          radius : deviceType() == \"desktop\" ? 8 : 10 // help cliquing on mobile.\n        })\n    })\n});\nmap.addLayer(vectorLayer);\n\n// add marker to map //\n\nlet data;\n  try {\n  data  = JSON.parse(dataJSON);\n  } catch(e) {\n  data = dataJSON;\n  }\n\n\nfor (let i = 0; i < data.length; i++) {\n    vectorLayer.getSource().addFeature(new Feature({\n        geometry: new Point([data[i].x,data[i].y]),\n        id : data[i].id,\n        color : data[i].color,\n        name : data[i].name,\n        nameEn : data[i].nameEn\n    }))\n}\n\nmap.on(\"pointermove\", function (e) {\n\n    // pointer\n\n    var hit = this.forEachFeatureAtPixel(e.pixel, function(feature, layer) {\n        return true;\n    });\n    if (hit) {\n        this.getTargetElement().style.cursor = 'pointer';\n        this.getTargetElement().style.fill = 'black';\n    } else {\n        this.getTargetElement().style.cursor = '';\n        this.getTargetElement().style.fill = '';\n    }\n});\n\nmap.on('singleclick', function (event) {\n\n    if (map.hasFeatureAtPixel(event.pixel) === true) {\n        var coordinate = event.coordinate;\n        const dataMap = map.getFeaturesAtPixel(event.pixel)[0].values_;\n\n        // Using data.JSON\n\n        const linkData = '<a style=\"font-family:sans-serif; text-decoration: none; color: '+dataMap.color+'\" target=\"_blank\" href=\"https://suttacentral.net/' + dataMap.id + '\">' + dataMap.nameEn + '&emsp;</a>';\n        content.innerHTML = linkData\n        overlay.setPosition(coordinate);\n\n        // Start SuttaPlex API for english titles\n\n        // GET Request.\n        // fetch('https://suttacentral.net/api/suttaplex/'+dataMap.id,{\n        //         method: \"GET\",\n        //         headers: {\"Content-type\": \"application/json;charset=UTF-8\"}\n        //       }\n        //     )\n        //     // Handle success\n        //     .then(response => response.json())  // convert to json\n        //     .then(json => {\n        //       const linkData = '<a style=\"font-family:sans-serif; text-decoration: none; color: '+dataMap.color+'\" target=\"_blank\" href=\"https://suttacentral.net/' + dataMap.id + '\"> Data : ' + dataMap.nameEn + '&emsp;</a>';\n        //       const linkAPI = '<a style=\"font-family:sans-serif; text-decoration: none; color: '+dataMap.color+'\" target=\"_blank\" href=\"https://suttacentral.net/api/suttaplex/'+dataMap.id+'\"> API : ' + json[0].translated_title + '&emsp;</a>';\n        //       content.innerHTML = linkData + '<br>' + linkAPI;\n        //       overlay.setPosition(coordinate);\n        //     })\n        //     .catch(err => {\n        //       console.log('Request Failed', err); //error details will be in the \"err\" object\n        //       content.innerHTML = '<a style=\"font-family:sans-serif; text-decoration: none; color: '+dataMap.color+'\" target=\"_blank\" href=\"https://suttacentral.net/' + dataMap.id + '\"> Data : ' + dataMap.nameEn + '&emsp;</a><br>' + \"API :\" + err + ' at: https://suttacentral.net/api/suttaplex/'+dataMap.id;\n        //       overlay.setPosition(coordinate);\n        //     }); // Catch errors\n\n      // End Suttaplex API\n    } else {\n        overlay.setPosition(undefined);\n        closer.blur();\n    }\n});\n"],"names":["defaultInteractions"],"mappings":"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"}